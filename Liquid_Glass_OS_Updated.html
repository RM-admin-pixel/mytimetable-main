<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyTimetable</title>
    <link rel="icon" type="image/png" href="https://i.ibb.co/Jwdd809/mytimetable-logo.png">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

```
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }
    
    :root {
        --accent-color: #00d4ff;
        --glass-bg: rgba(255, 255, 255, 0.1);
        --glass-border: rgba(255, 255, 255, 0.2);
        --text-primary: #ffffff;
        --text-secondary: rgba(255, 255, 255, 0.7);
        --shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
    }
    
    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        color: var(--text-primary);
        overflow-x: hidden;
        transition: background 0.5s ease;
    }
    
    body.dark-mode {
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
    }
    
    .aurora-bg {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        overflow: hidden;
    }
    
    .aurora-bg::before,
    .aurora-bg::after {
        content: '';
        position: absolute;
        width: 200%;
        height: 200%;
        animation: aurora 20s ease-in-out infinite;
    }
    
    .aurora-bg::before {
        background: radial-gradient(circle at 20% 50%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
                    radial-gradient(circle at 80% 80%, rgba(138, 35, 135, 0.3) 0%, transparent 50%);
        animation-delay: -10s;
    }
    
    .aurora-bg::after {
        background: radial-gradient(circle at 60% 70%, rgba(41, 128, 185, 0.3) 0%, transparent 50%),
                    radial-gradient(circle at 40% 40%, rgba(142, 68, 173, 0.3) 0%, transparent 50%);
    }
    
    @keyframes aurora {
        0%, 100% { transform: translate(0, 0) rotate(0deg); }
        33% { transform: translate(-5%, -5%) rotate(120deg); }
        66% { transform: translate(5%, 5%) rotate(240deg); }
    }
    
    /* Login Screen */
    .login-screen {
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        padding: 20px;
    }
    
    .login-card {
        background: var(--glass-bg);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border-radius: 20px;
        border: 1px solid var(--glass-border);
        box-shadow: var(--shadow);
        padding: 40px;
        max-width: 400px;
        width: 100%;
        text-align: center;
        animation: fadeIn 0.5s ease;
    }
    
    .login-card h1 {
        font-size: 32px;
        margin-bottom: 10px;
    }
    
    .login-card p {
        color: var(--text-secondary);
        margin-bottom: 30px;
    }
    
    .github-btn {
        background: #24292e;
        color: white;
        border: none;
        border-radius: 10px;
        padding: 15px 30px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        width: 100%;
    }
    
    .github-btn:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }
    
    .github-icon {
        width: 24px;
        height: 24px;
    }
    
    /* Main App */
    .glass-card {
        background: var(--glass-bg);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border-radius: 20px;
        border: 1px solid var(--glass-border);
        box-shadow: var(--shadow);
        padding: 20px;
        transition: all 0.3s ease;
    }
    
    .glass-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 40px 0 rgba(0, 0, 0, 0.5);
    }
    
    .nav-bar {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: 60px;
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(20px);
        border-bottom: 1px solid var(--glass-border);
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 20px;
        z-index: 1000;
    }
    
    .nav-icon {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        border-radius: 10px;
        transition: all 0.3s ease;
        font-size: 24px;
    }
    
    .nav-icon:hover {
        background: var(--glass-bg);
    }
    
    .nav-right {
        display: flex;
        gap: 10px;
        align-items: center;
    }
    
    .user-avatar {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        border: 2px solid var(--accent-color);
        cursor: pointer;
    }
    
    .container {
        max-width: 600px;
        margin: 0 auto;
        padding: 80px 20px 20px;
        min-height: 100vh;
    }
    
    .home-screen {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: calc(100vh - 100px);
    }
    
    .lesson-card {
        width: 100%;
        max-width: 500px;
        margin-bottom: 20px;
        text-align: center;
    }
    
    .lesson-label {
        font-size: 14px;
        color: var(--text-secondary);
        margin-bottom: 10px;
        text-transform: uppercase;
        letter-spacing: 2px;
    }
    
    .lesson-name {
        font-size: 32px;
        font-weight: 700;
        margin-bottom: 5px;
    }
    
    .lesson-time {
        font-size: 18px;
        color: var(--text-secondary);
    }
    
    .progress-container {
        width: 100%;
        max-width: 500px;
        margin: 30px 0;
    }
    
    .progress-label {
        display: flex;
        justify-content: space-between;
        margin-bottom: 10px;
        font-size: 14px;
        color: var(--text-secondary);
    }
    
    .progress-bar {
        width: 100%;
        height: 12px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        overflow: hidden;
        position: relative;
    }
    
    .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--accent-color), #00ff88);
        border-radius: 10px;
        transition: width 1s ease;
        box-shadow: 0 0 20px var(--accent-color);
        animation: shimmer 2s infinite;
    }
    
    @keyframes shimmer {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.8; }
    }
    
    .footer {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
    }
    
    .config-btn {
        background: var(--glass-bg);
        backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        color: var(--text-primary);
        padding: 10px 24px;
        border-radius: 20px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.3s ease;
    }
    
    .config-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: scale(1.05);
    }
    
    .menu-panel {
        position: fixed;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(30px);
        z-index: 2000;
        transition: left 0.3s ease;
        overflow-y: auto;
    }
    
    .menu-panel.active {
        left: 0;
    }
    
    .menu-content {
        padding: 80px 20px;
        max-width: 500px;
        margin: 0 auto;
    }
    
    .menu-item {
        background: var(--glass-bg);
        backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 15px;
        padding: 20px;
        margin-bottom: 15px;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 15px;
    }
    
    .menu-item:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateX(10px);
    }
    
    .menu-item-icon {
        font-size: 24px;
        width: 40px;
        text-align: center;
    }
    
    .menu-item-text {
        font-size: 18px;
        font-weight: 500;
    }
    
    .page {
        display: none;
    }
    
    .page.active {
        display: block;
    }
    
    .page-header {
        font-size: 28px;
        font-weight: 700;
        margin-bottom: 20px;
    }
    
    .timetable-day {
        background: var(--glass-bg);
        backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 15px;
        padding: 15px;
        margin-bottom: 15px;
    }
    
    .day-header {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 10px;
        color: var(--accent-color);
    }
    
    .lesson-item {
        padding: 10px;
        margin-bottom: 8px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 10px;
        display: flex;
        justify-content: space-between;
    }
    
    .hidden {
        display: none !important;
    }
    
    .btn {
        background: var(--accent-color);
        border: none;
        border-radius: 10px;
        padding: 12px 24px;
        color: white;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s ease;
        width: 100%;
        margin-top: 10px;
    }
    
    .btn:hover {
        transform: scale(1.02);
        box-shadow: 0 5px 15px rgba(0, 212, 255, 0.4);
    }
    
    .btn-danger {
        background: #ff4757;
    }
    
    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .fade-in {
        animation: fadeIn 0.5s ease;
    }
    
    .credit {
        position: fixed;
        bottom: 10px;
        right: 10px;
        font-size: 12px;
        color: var(--text-secondary);
        z-index: 100;
        opacity: 0.7;
    }
    
    .setting-item {
        background: var(--glass-bg);
        backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 15px;
        padding: 20px;
        margin-bottom: 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .setting-label {
        font-size: 16px;
        font-weight: 500;
    }
    
    .toggle-switch {
        width: 50px;
        height: 26px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 13px;
        position: relative;
        cursor: pointer;
        transition: background 0.3s ease;
    }
    
    .toggle-switch.active {
        background: var(--accent-color);
    }
    
    .toggle-slider {
        width: 22px;
        height: 22px;
        background: white;
        border-radius: 50%;
        position: absolute;
        top: 2px;
        left: 2px;
        transition: left 0.3s ease;
    }
    
    .toggle-switch.active .toggle-slider {
        left: 26px;
    }
    
    input[type="email"],
    input[type="password"] {
        outline: none;
    }
    
    input[type="email"]:focus,
    input[type="password"]:focus {
        border-color: var(--accent-color);
        box-shadow: 0 0 0 2px rgba(0, 212, 255, 0.2);
    }
    
    input::placeholder {
        color: rgba(255, 255, 255, 0.5);
    }
</style>
```

</head>
<body>
    <div class="aurora-bg"></div>
    <div class="credit">MyTimetable by Ronit Mantri</div>

```
<!-- Login Screen -->
<div id="loginScreen" class="login-screen">
    <div class="login-card">
        <h1>MyTimetable</h1>
        <p>Track your lessons, manage tasks, and stay organized with style</p>
        
        <!-- Loading state -->
        <div id="authLoading" style="display: block; padding: 30px 0;">
            <div style="font-size: 48px; margin-bottom: 15px;">‚è≥</div>
            <p style="color: var(--text-secondary);">Loading authentication...</p>
        </div>
        
        <!-- Auth buttons (hidden until Firebase loads) -->
        <div id="authButtons" style="display: none;">
            <!-- Email/Password Forms -->
            <div id="emailAuthForms">
            <!-- Sign In Form -->
            <div id="signInForm">
                <input type="email" id="signInEmail" placeholder="Email address" style="width: 100%; padding: 12px; margin-bottom: 10px; border-radius: 8px; border: 1px solid var(--glass-border); background: rgba(255, 255, 255, 0.1); color: white; font-size: 14px;">
                <input type="password" id="signInPassword" placeholder="Password" style="width: 100%; padding: 12px; margin-bottom: 15px; border-radius: 8px; border: 1px solid var(--glass-border); background: rgba(255, 255, 255, 0.1); color: white; font-size: 14px;">
                <button class="github-btn" onclick="signInWithEmail()" style="background: var(--accent-color); margin-bottom: 10px;">
                    üìß Sign In with Email
                </button>
                <p style="font-size: 12px; color: var(--text-secondary); margin-bottom: 15px;">
                    Don't have an account? <a href="#" onclick="toggleAuthForm(); return false;" style="color: var(--accent-color);">Sign up</a>
                </p>
            </div>
            
            <!-- Sign Up Form -->
            <div id="signUpForm" style="display: none;">
                <input type="email" id="signUpEmail" placeholder="Email address" style="width: 100%; padding: 12px; margin-bottom: 10px; border-radius: 8px; border: 1px solid var(--glass-border); background: rgba(255, 255, 255, 0.1); color: white; font-size: 14px;">
                <input type="password" id="signUpPassword" placeholder="Password (min 6 characters)" style="width: 100%; padding: 12px; margin-bottom: 15px; border-radius: 8px; border: 1px solid var(--glass-border); background: rgba(255, 255, 255, 0.1); color: white; font-size: 14px;">
                <button class="github-btn" onclick="signUpWithEmail()" style="background: var(--accent-color); margin-bottom: 10px;">
                    ‚ú® Create Account
                </button>
                <p style="font-size: 12px; color: var(--text-secondary); margin-bottom: 15px;">
                    Already have an account? <a href="#" onclick="toggleAuthForm(); return false;" style="color: var(--accent-color);">Sign in</a>
                </p>
            </div>
            
            <!-- Email Verification Message -->
            <div id="verificationMessage" style="display: none; padding: 15px; background: rgba(0, 255, 136, 0.2); border-radius: 10px; margin-bottom: 15px; border: 1px solid rgba(0, 255, 136, 0.3);">
                <p style="font-size: 14px; margin-bottom: 5px;">‚úÖ Verification email sent!</p>
                <p style="font-size: 12px; color: var(--text-secondary);">Please check your inbox and click the verification link.</p>
            </div>
        </div>
        
        <div style="display: flex; align-items: center; margin: 20px 0;">
            <div style="flex: 1; height: 1px; background: var(--glass-border);"></div>
            <span style="padding: 0 15px; font-size: 12px; color: var(--text-secondary);">OR</span>
            <div style="flex: 1; height: 1px; background: var(--glass-border);"></div>
        </div>
        
        <button class="github-btn" onclick="signInWithGoogle()" style="background: #4285f4; margin-bottom: 10px;">
            <svg class="github-icon" viewBox="0 0 24 24" fill="white">
                <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
            </svg>
            Continue with Google
        </button>
        
        <button class="github-btn" onclick="signInWithGitHub()">
            <svg class="github-icon" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
            </svg>
            Continue with GitHub
        </button>
        
        <div style="display: flex; align-items: center; margin: 20px 0;">
            <div style="flex: 1; height: 1px; background: var(--glass-border);"></div>
            <span style="padding: 0 15px; font-size: 12px; color: var(--text-secondary);">OR</span>
            <div style="flex: 1; height: 1px; background: var(--glass-border);"></div>
        </div>
        
        <button class="github-btn" onclick="signInAnonymously()" style="background: rgba(255, 255, 255, 0.1);">
            üï∂Ô∏è Continue Anonymously
        </button>
        
        <p style="font-size: 11px; color: var(--text-secondary); margin-top: 15px;">
            Anonymous mode: Your data is temporary and will be lost when you sign out
        </p>
        </div><!-- end authButtons -->
    </div>
</div>

<!-- Main App -->
<div id="mainApp" class="hidden">
    <div class="nav-bar">
        <div class="nav-icon" id="menuBtn">‚ò∞</div>
        <div class="nav-right">
            <img id="userAvatar" class="user-avatar" src="" alt="User">
            <div class="nav-icon hidden" id="backBtn">‚Üê</div>
            <div class="nav-icon hidden" id="homeBtn">üè†</div>
        </div>
    </div>
    
    <div class="container">
        <div class="page active" id="homePage">
            <div class="home-screen">
                <div class="lesson-card glass-card fade-in">
                    <div class="lesson-label">Current Lesson</div>
                    <div class="lesson-name" id="currentLesson">Loading...</div>
                    <div class="lesson-time" id="currentTime">--:-- -- - --:-- --</div>
                </div>
                
                <div class="progress-container">
                    <div class="progress-label">
                        <span>Day Progress</span>
                        <span id="progressPercent">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                    </div>
                </div>
                
                <div class="lesson-card glass-card fade-in">
                    <div class="lesson-label">Next Lesson</div>
                    <div class="lesson-name" id="nextLesson">Loading...</div>
                    <div class="lesson-time" id="nextTime">--:-- -- - --:-- --</div>
                </div>
            </div>
            
            <div class="footer">
                <button class="config-btn" id="configBtn">‚öôÔ∏è Config</button>
            </div>
        </div>
        
        <div class="page" id="timetablePage">
            <h1 class="page-header">üìÖ Timetable</h1>
            <div id="timetableContent"></div>
        </div>
        
        <div class="page" id="settingsPage">
            <h1 class="page-header">‚öôÔ∏è Settings</h1>
            
            <div class="setting-item">
                <div class="setting-label">Dark Mode</div>
                <div class="toggle-switch" id="darkModeToggle" onclick="toggleDarkMode()">
                    <div class="toggle-slider"></div>
                </div>
            </div>
            
            <div class="setting-item">
                <div class="setting-label">Motion Effects</div>
                <div class="toggle-switch active" id="motionToggle" onclick="toggleMotion()">
                    <div class="toggle-slider"></div>
                </div>
            </div>
            
            <button class="btn btn-danger" onclick="signOut()">üö™ Sign Out</button>
        </div>
    </div>
</div>

<!-- Menu Panel -->
<div class="menu-panel" id="menuPanel">
    <div class="menu-content">
        <h2 style="margin-bottom: 30px; font-size: 32px;">Menu</h2>
        
        <div class="menu-item" onclick="navigateTo('timetable')">
            <div class="menu-item-icon">üìÖ</div>
            <div class="menu-item-text">Timetable</div>
        </div>
        
        <div class="menu-item" onclick="navigateTo('settings')">
            <div class="menu-item-icon">‚öôÔ∏è</div>
            <div class="menu-item-text">Settings</div>
        </div>
    </div>
</div>

<script>
    // Firebase initialization with proper loading state
    function initializeApp() {
        // Check if Firebase SDK is loaded
        if (typeof firebase === 'undefined') {
            console.error('‚ùå Firebase SDK not loaded');
            document.getElementById('authLoading').innerHTML = `
                <div style="font-size: 48px; margin-bottom: 15px;">‚ùå</div>
                <p style="color: #ff4757; font-weight: bold;">Firebase SDK failed to load</p>
                <p style="font-size: 12px; color: var(--text-secondary); margin: 15px 0;">
                    Check your internet connection and refresh the page.
                </p>
                <button class="github-btn" onclick="window.location.reload()" style="background: var(--accent-color);">
                    üîÑ Refresh Page
                </button>
            `;
            return;
        }
        
        console.log('‚úÖ Firebase SDK loaded');
        
        const firebaseConfig = {
            apiKey: "AIzaSyA1bLj9fg4xypAGwnrG4jBoyB8RfRMsZGI",
            authDomain: "mytimetable-official.firebaseapp.com",
            projectId: "mytimetable-official",
            storageBucket: "mytimetable-official.firebasestorage.app",
            messagingSenderId: "635107411737",
            appId: "1:635107411737:web:e4bc61644219acb6bf6788",
            measurementId: "G-HP3HXPN9WJ"
        };
        
        try {
            firebase.initializeApp(firebaseConfig);
            window.auth = firebase.auth();
            window.db = firebase.firestore();
            
            console.log('‚úÖ Firebase initialized successfully!');
            console.log('‚úÖ Auth ready:', !!window.auth);
            console.log('‚úÖ Firestore ready:', !!window.db);
            
            // Hide loading, show auth buttons
            document.getElementById('authLoading').style.display = 'none';
            document.getElementById('authButtons').style.display = 'block';
            
            // Setup auth listener
            setupAuthListener();
        } catch (error) {
            console.error('‚ùå Firebase initialization error:', error);
            document.getElementById('authLoading').innerHTML = `
                <div style="font-size: 48px; margin-bottom: 15px;">‚ùå</div>
                <p style="color: #ff4757; font-weight: bold;">Firebase initialization failed</p>
                <p style="font-size: 12px; color: var(--text-secondary); margin: 15px 0;">
                    ${error.message}
                </p>
                <button class="github-btn" onclick="window.location.reload()" style="background: var(--accent-color);">
                    üîÑ Try Again
                </button>
            `;
        }
    }
    
    // Make auth and db globally accessible
    let auth, db;
    
    let currentUser = null;
    let currentPage = 'home';
    let isGuestMode = false;
    
    // Corrected GEMS Wellington Class 6B Timetable (2025/26)
    const timetable = {
        Monday: [
            { name: 'Library', time: '7:40 AM - 7:50 AM' },
            { name: 'Maths', time: '7:50 AM - 8:50 AM' },
            { name: 'SPAG', time: '8:50 AM - 9:10 AM' },
            { name: 'Physical Education', time: '9:10 AM - 10:10 AM' },
            { name: 'Break (TT)', time: '10:10 AM - 10:30 AM' },
            { name: 'Assembly', time: '10:50 AM - 11:30 AM' },
            { name: 'English', time: '11:30 AM - 12:30 PM' },
            { name: 'Guided Reading', time: '12:30 PM - 1:10 PM' },
            { name: 'Lunch', time: '1:10 PM - 1:50 PM' },
            { name: 'Arabic A/B', time: '1:50 PM - 2:50 PM' },
            { name: 'Library', time: '2:50 PM - 3:00 PM' }
        ],
        Tuesday: [
            { name: 'Maths', time: '7:50 AM - 8:50 AM' },
            { name: 'SPAG', time: '8:50 AM - 9:10 AM' },
            { name: 'Art / Design Technology', time: '9:10 AM - 10:10 AM' },
            { name: 'Break (TT)', time: '10:10 AM - 10:30 AM' },
            { name: 'Islamic A/B', time: '10:30 AM - 11:30 AM' },
            { name: 'English', time: '11:30 AM - 12:30 PM' },
            { name: 'Performing Arts', time: '12:30 PM - 1:10 PM' },
            { name: 'Lunch', time: '1:10 PM - 1:50 PM' },
            { name: 'Science', time: '1:50 PM - 2:50 PM' }
        ],
        Wednesday: [
            { name: 'English', time: '7:50 AM - 8:50 AM' },
            { name: 'Homework', time: '8:50 AM - 9:10 AM' },
            { name: 'Music', time: '9:10 AM - 10:10 AM' },
            { name: 'Break (GW)', time: '10:10 AM - 10:30 AM' },
            { name: 'Moral, Social and Cultural Studies', time: '10:30 AM - 11:30 AM' },
            { name: 'Arabic A/B', time: '11:30 AM - 12:30 PM' },
            { name: 'Islamic A/B', time: '12:30 PM - 1:10 PM' },
            { name: 'Lunch', time: '1:10 PM - 1:50 PM' },
            { name: 'Maths', time: '1:50 PM - 2:50 PM' }
        ],
        Thursday: [
            { name: 'Arabic A', time: '7:50 AM - 8:50 AM' },
            { name: 'Spelling Test', time: '8:50 AM - 9:10 AM' },
            { name: 'Physical Education', time: '9:10 AM - 10:10 AM' },
            { name: 'Break (GW)', time: '10:10 AM - 10:30 AM' },
            { name: 'Guided Reading', time: '10:30 AM - 11:30 AM' },
            { name: 'English', time: '11:30 AM - 12:30 PM' },
            { name: 'Science', time: '12:30 PM - 1:10 PM' },
            { name: 'Lunch', time: '1:10 PM - 1:50 PM' },
            { name: 'Maths', time: '1:50 PM - 2:50 PM' }
        ],
        Friday: [
            { name: 'Humanities', time: '7:40 AM - 8:40 AM' },
            { name: 'Mental Maths', time: '8:40 AM - 9:20 AM' },
            { name: 'Arabic A/B', time: '9:20 AM - 10:20 AM' },
            { name: 'Break', time: '10:20 AM - 10:40 AM' },
            { name: 'Languages', time: '10:40 AM - 11:40 AM' },
            { name: 'End of Day', time: '11:40 AM - 12:00 PM' }
        ]
    };
    
    // Authentication
    async function signInWithGoogle() {
        console.log('üîµ Google sign-in button clicked');
        
        if (!window.auth) {
            console.error('‚ùå window.auth is not initialized');
            showNotification('‚ùå Authentication not ready. Please refresh the page.');
            return;
        }
        
        console.log('‚úÖ window.auth exists, creating provider...');
        
        try {
            const provider = new firebase.auth.GoogleAuthProvider();
            console.log('‚úÖ Provider created, opening popup...');
            
            const result = await window.auth.signInWithPopup(provider);
            console.log('‚úÖ Google sign-in successful!', result.user.email);
            showNotification('‚úÖ Welcome ' + (result.user.displayName || result.user.email) + '!');
        } catch (error) {
            console.error('‚ùå Google sign-in error:', {
                code: error.code,
                message: error.message,
                stack: error.stack
            });
            
            if (error.code === 'auth/popup-closed-by-user') {
                showNotification('‚ö†Ô∏è Sign-in cancelled');
            } else if (error.code === 'auth/popup-blocked') {
                showNotification('‚ùå Please allow popups for this site');
            } else if (error.code === 'auth/unauthorized-domain') {
                showNotification('‚ùå Domain not authorized. Add ' + window.location.hostname + ' to Firebase Console.');
            } else if (error.code === 'auth/operation-not-allowed') {
                showNotification('‚ùå Google sign-in is not enabled in Firebase Console');
            } else {
                showNotification('‚ùå Google sign-in failed: ' + error.message);
            }
        }
    }
    
    async function signInWithGitHub() {
        console.log('üêô GitHub sign-in button clicked');
        
        if (!window.auth) {
            console.error('‚ùå window.auth is not initialized');
            showNotification('‚ùå Authentication not ready. Please refresh the page.');
            return;
        }
        
        console.log('‚úÖ window.auth exists, creating provider...');
        
        try {
            const provider = new firebase.auth.GithubAuthProvider();
            console.log('‚úÖ Provider created, opening popup...');
            
            const result = await window.auth.signInWithPopup(provider);
            console.log('‚úÖ GitHub sign-in successful!', result.user.email);
            showNotification('‚úÖ Welcome ' + (result.user.displayName || result.user.email) + '!');
        } catch (error) {
            console.error('‚ùå GitHub sign-in error:', {
                code: error.code,
                message: error.message,
                stack: error.stack
            });
            
            if (error.code === 'auth/popup-closed-by-user') {
                showNotification('‚ö†Ô∏è Sign-in cancelled');
            } else if (error.code === 'auth/popup-blocked') {
                showNotification('‚ùå Please allow popups for this site');
            } else if (error.code === 'auth/account-exists-with-different-credential') {
                showNotification('‚ùå Account exists with different sign-in method');
            } else if (error.code === 'auth/unauthorized-domain') {
                showNotification('‚ùå Domain not authorized. Add ' + window.location.hostname + ' to Firebase Console.');
            } else if (error.code === 'auth/operation-not-allowed') {
                showNotification('‚ùå GitHub sign-in is not enabled in Firebase Console');
            } else {
                showNotification('‚ùå GitHub sign-in failed: ' + error.message);
            }
        }
    }
    
    async function signUpWithEmail() {
        const email = document.getElementById('signUpEmail').value.trim();
        const password = document.getElementById('signUpPassword').value;
        
        if (!email || !password) {
            showNotification('‚ùå Please fill in all fields');
            return;
        }
        
        if (password.length < 6) {
            showNotification('‚ùå Password must be at least 6 characters');
            return;
        }
        
        try {
            const userCredential = await window.auth.createUserWithEmailAndPassword(email, password);
            
            // Send verification email
            await userCredential.user.sendEmailVerification();
            
            // Sign out until email is verified
            await window.auth.signOut();
            
            // Show verification message
            document.getElementById('emailAuthForms').style.display = 'none';
            document.getElementById('verificationMessage').style.display = 'block';
            showNotification('‚úÖ Account created! Check your email to verify.');
        } catch (error) {
            console.error('Error signing up:', error);
            let errorMessage = 'Sign up failed';
            
            if (error.code === 'auth/email-already-in-use') {
                errorMessage = 'Email already in use';
            } else if (error.code === 'auth/invalid-email') {
                errorMessage = 'Invalid email address';
            } else if (error.code === 'auth/weak-password') {
                errorMessage = 'Password is too weak';
            }
            
            showNotification('‚ùå ' + errorMessage);
        }
    }
    
    async function signInWithEmail() {
        const email = document.getElementById('signInEmail').value.trim();
        const password = document.getElementById('signInPassword').value;
        
        if (!email || !password) {
            showNotification('‚ùå Please fill in all fields');
            return;
        }
        
        try {
            const userCredential = await window.auth.signInWithEmailAndPassword(email, password);
            
            // Check if email is verified
            if (!userCredential.user.emailVerified) {
                await window.auth.signOut();
                showNotification('‚ùå Please verify your email first. Check your inbox.');
                return;
            }
            
            showNotification('‚úÖ Welcome back!');
        } catch (error) {
            console.error('Error signing in:', error);
            let errorMessage = 'Sign in failed';
            
            if (error.code === 'auth/user-not-found' || error.code === 'auth/wrong-password') {
                errorMessage = 'Invalid email or password';
            } else if (error.code === 'auth/invalid-email') {
                errorMessage = 'Invalid email address';
            }
            
            showNotification('‚ùå ' + errorMessage);
        }
    }
    
    async function signInAnonymously() {
        try {
            await window.auth.signInAnonymously();
            showNotification('üï∂Ô∏è Signed in anonymously');
        } catch (error) {
            console.error('Error signing in anonymously:', error);
            showNotification('‚ùå Anonymous sign-in failed: ' + error.message);
        }
    }
    
    function continueAsGuest() {
        isGuestMode = true;
        currentUser = {
            uid: 'guest-' + Date.now(),
            email: 'guest@liquidglass.local',
            photoURL: 'https://ui-avatars.com/api/?name=Guest&background=00d4ff&color=fff'
        };
        
        document.getElementById('loginScreen').classList.add('hidden');
        document.getElementById('mainApp').classList.remove('hidden');
        
        // Set guest avatar
        document.getElementById('userAvatar').src = currentUser.photoURL;
        
        // Initialize app in guest mode
        initGuestMode();
        
        showNotification('üë§ Logged in as Guest');
    }
    
    function initGuestMode() {
        loadLocalSettings();
        updateCurrentLesson();
        loadTimetable();
        updateProgress();
        
        setInterval(updateProgress, 60000);
        setInterval(updateCurrentLesson, 60000);
    }
    
    function loadLocalSettings() {
        const darkMode = localStorage.getItem('guest_dark_mode') === 'true';
        const motionEffects = localStorage.getItem('guest_motion_effects') !== 'false';
        
        if (darkMode) {
            document.body.classList.add('dark-mode');
            document.getElementById('darkModeToggle').classList.add('active');
        }
        
        if (!motionEffects) {
            document.getElementById('motionToggle').classList.remove('active');
            document.querySelector('.aurora-bg').style.display = 'none';
        }
    }
    
    function toggleAuthForm() {
        const signInForm = document.getElementById('signInForm');
        const signUpForm = document.getElementById('signUpForm');
        const verificationMessage = document.getElementById('verificationMessage');
        
        // Hide verification message
        verificationMessage.style.display = 'none';
        document.getElementById('emailAuthForms').style.display = 'block';
        
        if (signInForm.style.display === 'none') {
            signInForm.style.display = 'block';
            signUpForm.style.display = 'none';
        } else {
            signInForm.style.display = 'none';
            signUpForm.style.display = 'block';
        }
    }
    
    async function signOut() {
        if (isGuestMode) {
            isGuestMode = false;
            currentUser = null;
            window.location.reload();
        } else {
            try {
                await window.auth.signOut();
                window.location.reload();
            } catch (error) {
                console.error('Error signing out:', error);
            }
        }
    }
    
    // Check authentication state
    function setupAuthListener() {
        auth = window.auth;
        db = window.db;
        
        auth.onAuthStateChanged((user) => {
            if (user) {
                // Check if email is verified for email/password users (skip for anonymous)
                if (!user.isAnonymous && user.providerData[0]?.providerId === 'password' && !user.emailVerified) {
                    showNotification('‚ö†Ô∏è Please verify your email to continue');
                    auth.signOut();
                    return;
                }
                
                currentUser = user;
                document.getElementById('loginScreen').classList.add('hidden');
                document.getElementById('mainApp').classList.remove('hidden');
                
                // Set user avatar
                if (user.isAnonymous) {
                    // Anonymous user avatar
                    document.getElementById('userAvatar').src = 'https://ui-avatars.com/api/?name=Anonymous&background=888888&color=fff';
                } else if (user.photoURL) {
                    document.getElementById('userAvatar').src = user.photoURL;
                } else {
                    // Set default avatar for email users
                    document.getElementById('userAvatar').src = 'https://ui-avatars.com/api/?name=' + encodeURIComponent(user.email || 'User') + '&background=00d4ff&color=fff';
                }
                
                // Initialize app
                init();
            } else {
                document.getElementById('loginScreen').classList.remove('hidden');
                document.getElementById('mainApp').classList.add('hidden');
            }
        });
    }
    
    // Initialize app
    async function init() {
        await loadUserSettings();
        updateCurrentLesson();
        loadTimetable();
        updateProgress();
        
        setInterval(updateProgress, 60000);
        setInterval(updateCurrentLesson, 60000);
    }
    
    // Load user settings from Firebase or localStorage
    async function loadUserSettings() {
        if (isGuestMode || (currentUser && currentUser.isAnonymous)) {
            loadLocalSettings();
            return;
        }
        
        try {
            const docRef = window.db.collection('user_settings').doc(currentUser.uid);
            const doc = await docRef.get();
            
            if (doc.exists) {
                const data = doc.data();
                
                if (data.dark_mode) {
                    document.body.classList.add('dark-mode');
                    document.getElementById('darkModeToggle').classList.add('active');
                }
                
                if (data.motion_effects === false) {
                    document.getElementById('motionToggle').classList.remove('active');
                    document.querySelector('.aurora-bg').style.display = 'none';
                }
                
                if (data.accent_color) {
                    document.documentElement.style.setProperty('--accent-color', data.accent_color);
                }
            }
        } catch (error) {
            console.error('Error loading settings:', error);
        }
    }
    
    // Save user settings to Firebase or localStorage
    async function saveUserSettings() {
        const darkMode = document.getElementById('darkModeToggle').classList.contains('active');
        const motionEffects = document.getElementById('motionToggle').classList.contains('active');
        
        if (isGuestMode || (currentUser && currentUser.isAnonymous)) {
            // Save to localStorage for guest/anonymous mode
            localStorage.setItem('guest_dark_mode', darkMode);
            localStorage.setItem('guest_motion_effects', motionEffects);
            showNotification('‚úÖ Settings saved locally (Anonymous mode)');
        } else {
            // Save to Firebase for authenticated users
            try {
                await window.db.collection('user_settings').doc(currentUser.uid).set({
                    user_id: currentUser.uid,
                    dark_mode: darkMode,
                    motion_effects: motionEffects,
                    updated_at: firebase.firestore.FieldValue.serverTimestamp()
                }, { merge: true });
                
                showNotification('‚úÖ Settings saved successfully!');
            } catch (error) {
                console.error('Error saving settings:', error);
                showNotification('‚ö†Ô∏è Settings saved locally only');
            }
        }
    }
    
    // Navigation
    function navigateTo(page) {
        const pages = document.querySelectorAll('.page');
        pages.forEach(p => p.classList.remove('active'));
        
        const targetPage = document.getElementById(page + 'Page');
        if (targetPage) {
            targetPage.classList.add('active');
            currentPage = page;
            
            if (page === 'home') {
                document.getElementById('backBtn').classList.add('hidden');
                document.getElementById('homeBtn').classList.add('hidden');
            } else {
                document.getElementById('backBtn').classList.remove('hidden');
                document.getElementById('homeBtn').classList.remove('hidden');
            }
        }
        
        if (page === 'timetable') {
            loadTimetable();
        }
        
        closeMenu();
    }
    
    document.getElementById('menuBtn').addEventListener('click', () => {
        document.getElementById('menuPanel').classList.add('active');
    });
    
    function closeMenu() {
        document.getElementById('menuPanel').classList.remove('active');
    }
    
    document.getElementById('menuPanel').addEventListener('click', (e) => {
        if (e.target.id === 'menuPanel') {
            closeMenu();
        }
    });
    
    document.getElementById('backBtn').addEventListener('click', () => {
        navigateTo('home');
    });
    
    document.getElementById('homeBtn').addEventListener('click', () => {
        navigateTo('home');
    });
    
    document.getElementById('configBtn').addEventListener('click', () => {
        navigateTo('settings');
    });
    
    // Toggle functions
    async function toggleDarkMode() {
        document.getElementById('darkModeToggle').classList.toggle('active');
        document.body.classList.toggle('dark-mode');
        await saveUserSettings();
    }
    
    async function toggleMotion() {
        document.getElementById('motionToggle').classList.toggle('active');
        const isActive = document.getElementById('motionToggle').classList.contains('active');
        document.querySelector('.aurora-bg').style.display = isActive ? 'block' : 'none';
        await saveUserSettings();
    }
    
    // Update current lesson
    function updateCurrentLesson() {
        const now = new Date();
        const dayName = now.toLocaleDateString('en-US', { weekday: 'long' });
        
        const todayLessons = timetable[dayName] || [];
        let currentLesson = null;
        let nextLesson = null;
        
        for (let i = 0; i < todayLessons.length; i++) {
            const lesson = todayLessons[i];
            const [start, end] = lesson.time.split(' - ').map(t => parseTime(t));
            
            if (now >= start && now < end) {
                currentLesson = lesson;
                nextLesson = todayLessons[i + 1] || null;
                break;
            } else if (now < start) {
                nextLesson = lesson;
                break;
            }
        }
        
        if (currentLesson) {
            document.getElementById('currentLesson').textContent = currentLesson.name;
            document.getElementById('currentTime').textContent = currentLesson.time;
        } else {
            document.getElementById('currentLesson').textContent = 'No Lesson';
            document.getElementById('currentTime').textContent = 'Free Time';
        }
        
        if (nextLesson) {
            document.getElementById('nextLesson').textContent = nextLesson.name;
            document.getElementById('nextTime').textContent = nextLesson.time;
        } else {
            document.getElementById('nextLesson').textContent = 'No More Lessons';
            document.getElementById('nextTime').textContent = 'Enjoy your day!';
        }
    }
    
    function parseTime(timeStr) {
        const [time, period] = timeStr.split(' ');
        let [hours, minutes] = time.split(':').map(Number);
        
        if (period === 'PM' && hours !== 12) hours += 12;
        if (period === 'AM' && hours === 12) hours = 0;
        
        const date = new Date();
        date.setHours(hours, minutes, 0, 0);
        return date;
    }
    
    // Update progress
    function updateProgress() {
        const now = new Date();
        const startOfDay = new Date(now);
        startOfDay.setHours(7, 40, 0, 0);
        const endOfDay = new Date(now);
        endOfDay.setHours(14, 50, 0, 0);
        
        if (now < startOfDay) {
            document.getElementById('progressFill').style.width = '0%';
            document.getElementById('progressPercent').textContent = '0%';
        } else if (now > endOfDay) {
            document.getElementById('progressFill').style.width = '100%';
            document.getElementById('progressPercent').textContent = '100%';
        } else {
            const total = endOfDay - startOfDay;
            const elapsed = now - startOfDay;
            const percent = Math.round((elapsed / total) * 100);
            document.getElementById('progressFill').style.width = percent + '%';
            document.getElementById('progressPercent').textContent = percent + '%';
        }
    }
    
    // Load timetable
    function loadTimetable() {
        const container = document.getElementById('timetableContent');
        container.innerHTML = '';
        
        Object.keys(timetable).forEach(day => {
            const dayDiv = document.createElement('div');
            dayDiv.className = 'timetable-day fade-in';
            
            let html = `<div class="day-header">${day}</div>`;
            timetable[day].forEach(lesson => {
                html += `
                    <div class="lesson-item">
                        <span>${lesson.name}</span>
                        <span style="color: var(--text-secondary);">${lesson.time}</span>
                    </div>
                `;
            });
            
            dayDiv.innerHTML = html;
            container.appendChild(dayDiv);
        });
    }
    
    // Notification
    function showNotification(message, duration = 3000) {
        const notification = document.createElement('div');
        notification.style.cssText = `
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            padding: 15px 25px;
            border-radius: 15px;
            z-index: 10000;
            animation: fadeIn 0.3s ease;
            box-shadow: var(--shadow);
        `;
        notification.textContent = message;
        document.body.appendChild(notification);
        
        setTimeout(() => {
            notification.remove();
        }, duration);
    }
    
    // Start initialization when scripts are ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializeApp);
    } else {
        initializeApp();
    }
</script>
```

</body>
</html>